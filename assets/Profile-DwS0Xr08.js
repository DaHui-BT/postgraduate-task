import{d as w,g as N,r as y,o as a,c as i,b as e,F as x,k as I,t as g,l as z,a as ee,p as R,f as X,_ as M,m as V,e as D,n as te,D as G,q as H,i as K,s as T,x as Q,j as Y,w as W,v as L,y as se,u as ae}from"./index-Bm0dTqqU.js";import{h as b}from"./moment-C5S46NFB.js";const oe=o=>(R("data-v-91b47bab"),o=o(),X(),o),le={class:"submission-chart"},ne={class:"calendar"},ie=oe(()=>e("div",{class:"weeks"},[e("div",{class:"week"},"Mon"),e("div",{class:"week"},"Wed"),e("div",{class:"week"},"Fri")],-1)),de={class:"title"},re=ee('<div class="operation" data-v-91b47bab><div class="slider" data-v-91b47bab><div class="slider-desc" data-v-91b47bab>0</div><div style="width:120px;" data-v-91b47bab></div><div class="slider-desc" data-v-91b47bab>12+</div></div><div class="legend" data-v-91b47bab><div class="level-desc" data-v-91b47bab>less</div><div class="level level-1" data-v-91b47bab></div><div class="level level-2" data-v-91b47bab></div><div class="level level-3" data-v-91b47bab></div><div class="level level-4" data-v-91b47bab></div><div class="level level-5" data-v-91b47bab></div><div class="level-desc" data-v-91b47bab>more</div></div></div>',1),ce=w({__name:"SubmissionChart",props:["submission_list","profile"],setup(o){const d=o,s=N([]),f=N([]),r=y([0,12]),c=["Jul","Aug","Sep","Oct","Nov","Dec","Jan","Feb","Mar","Apr","May","Jun","Jul"];function l(){let t=parseInt(b().format("YYYY"))-1+"-"+b().format("MM-DD"),_=b(t).format("YYYY-MM-DD"),u=b(_).weekday()||7,k=u>1?b(_).add(8-u,"days").format("YYYY-MM-DD"):_,n=b().diff(b(k),"days")+1,m=7,h=Math.ceil(n/m),Z=r.value[0],E=r.value[1];for(let v=0;v<h;v++){let O=v===h-1&&n%m?n%m:m,P=b(k).add(v*7,"days").format("M"),q=b(k).add(v*7+O,"days").format("M"),A=v===0?c[parseInt(P)-1]:"",J=!1;parseInt(q)-parseInt(P)&&(J=!0),v&&s[v-1].ifSwitchMonth&&(A=c[parseInt(q)-1]),s.push({columns:O,title:A,ifSwitchMonth:J,data:[]});for(let B=0;B<s[v].columns;B++){let C=b(k).add(v*7+B,"days").format("YYYY-MM-DD"),U=0;(f[C]>=Z&&f[C]<E||f[C]>12&&E===12)&&(U=f[C]),s[v].data.push({number:U,date:C})}}}function $(){let p=d.submission_list;for(let t of p)s.forEach(_=>{for(let u of _.data)u.date.slice(2,u.date.length)==b(t.date).format("YY-MM-DD")&&u.number++})}function S(p){let t="#EBEDF0";return p>=12?t="#196127":p>=8?t="#239A3B":p>=4?t="#7BC96F":p>=1?t="#C6E48B":t="#EBEDF0",t}return l(),$(),(p,t)=>(a(),i("div",le,[e("div",ne,[ie,(a(!0),i(x,null,I(s,(_,u)=>(a(),i("div",{class:"column",key:u},[e("div",de,g(_.title),1),(a(!0),i(x,null,I(_.data,(k,n)=>(a(),i("div",{class:"date-wrapper",key:n,style:z(`background:${S(k.number)};`)},null,4))),128))]))),128))]),re]))}}),ue=M(ce,[["__scopeId","data-v-91b47bab"]]),fe=w({__name:"Tooltip",props:{message:{type:String,required:!0},backgroundColor:{type:String,default:"rgba(0, 0, 0, 0.75)"},textColor:{type:String,default:"white"}},setup(o){const d=y(!1);function s(){d.value=!0}function f(){d.value=!1}return(r,c)=>(a(),i("div",{class:"hover-tip-container",onMouseenter:s,onMouseleave:f},[V(r.$slots,"default",{},void 0),d.value?(a(),i("div",{key:0,class:"hover-tip-message",style:z({backgroundColor:o.backgroundColor,color:o.textColor})},g(o.message),5)):D("",!0)],32))}}),j=M(fe,[["__scopeId","data-v-ae4ac1cc"]]),pe=w({__name:"ScreenMask",props:{center:{type:Boolean,default:!0}},setup(o){return(d,s)=>(a(),i("div",{class:te({"screen-mask":!0,"screen-mask-center":o.center})},[V(d.$slots,"default",{},void 0)],2))}}),me=M(pe,[["__scopeId","data-v-fc0756af"]]),_e={class:"form"},ve=w({__name:"FormTable",props:{submit_text:{type:String,default:"Submit"}},emits:["close","submit"],setup(o,{emit:d}){const s=d;function f(){s("close")}function r(){s("submit")}return(c,l)=>(a(),i("div",_e,[e("button",{class:"form-close",onClick:f},"X"),V(c.$slots,"default",{},void 0),e("button",{class:"form-button",onClick:r},g(o.submit_text),1)]))}}),be=M(ve,[["__scopeId","data-v-c51e13e2"]]),ke={class:"task-form"},he={class:"task-form-item-number"},ye=["onUpdate:modelValue"],ge=["onUpdate:modelValue"],$e=w({__name:"TaskForm",props:{is_update:{type:Boolean,required:!0}},emits:["close","show"],setup(o,{emit:d}){const s=d;let f=o;const{proxy:r}=Q(),c=new G,l=y({task_list:[{name:"",describe:""}]});H(()=>{r.$loading.show(),c.findOne("postgraduate-task","task").then(t=>{t!=null&&(l.value=t)}).finally(()=>{r.$loading.hide()})});function $(){l.value.task_list.push({name:"",describe:""})}function S(){console.log(l);for(let t of l.value.task_list)if(t.name.trim().length==0||t.describe.trim().length==0){alert("name or describe must not be null");return}l.value.date=new Date,r.$loading.show(),f.is_update?c.updateOne("postgraduate-task","task",{_id:{$eq:l.value._id}},l.value).then(t=>{alert("update success"),p()}).finally(()=>{r.$loading.hide()}):c.addOne("postgraduate-task","task",l.value).then(t=>{console.log(t),alert("submit success"),p()}).catch(t=>{console.log(t)}).finally(()=>{r.$loading.hide()})}function p(){s("close")}return(t,_)=>(a(),K(me,null,{default:T(()=>[Y(be,{onClose:p,onSubmit:S},{default:T(()=>[e("ol",ke,[(a(!0),i(x,null,I(l.value.task_list,(u,k)=>(a(),i("li",{class:"task-form-item",key:u},[e("span",he,g(k+1)+".",1),W(e("input",{class:"task-form-input task-form-input-name",placeholder:"task name","onUpdate:modelValue":n=>u.name=n},null,8,ye),[[L,u.name]]),W(e("input",{class:"task-form-input",placeholder:"task describe","onUpdate:modelValue":n=>u.describe=n},null,8,ge),[[L,u.describe]]),e("button",{class:"task-form-add",onClick:$},"+")]))),128))])]),_:1})]),_:1}))}}),we=M($e,[["__scopeId","data-v-c0a02e8a"]]),F=o=>(R("data-v-e644a59f"),o=o(),X(),o),Me={class:"profile"},Se=F(()=>e("h2",null,"Profile",-1)),Ce={class:"profile-info"},De={class:"profile-task"},Ye={key:2,class:"profile-task-container"},xe=F(()=>e("span",{class:"profile-task-item-name"},"name: ",-1)),Ie=F(()=>e("span",{class:"profile-task-item-descirbe"},"describe: ",-1)),Te={key:3,class:"profile-task-no"},Fe=F(()=>e("textarea",{class:"profile-sticky-node",rows:"3",placeholder:"Mood Post-it notes, post daily mood"},null,-1)),Be={key:1,class:"contribute"},Ne=w({__name:"Profile",setup(o){const{proxy:d}=Q(),s=new G,f=y(!1),r=y(!1),c=N([]),l=y();let $=y(0),S=y(null),p=y(null);H(()=>{d.$loading.show(),s.findList("postgraduate-task","submission").then(n=>{c.splice(0,c.length),n&&c.push(...n)}).finally(()=>{d.$loading.hide()}),s.count("postgraduate-task","submission",{date:{$gt:new Date(new Date().toLocaleDateString())}}).then(n=>{$.value=n}),s.findOne("postgraduate-task","task").then(n=>{l.value=n,s.findOne("postgraduate-task","task").then(m=>{l.value=m}).catch(m=>{console.log(m)})}).catch(n=>{console.log(n)})});function t(){alert("stay tuned to be expected")}function _(){f.value=!0,r.value=!1}function u(){f.value=!0,r.value=!0}function k(){if(!confirm("is ready to delete task!")){alert("operate already canceled!");return}d.$loading.show(),s.deleteOne("postgraduate-task","task",{name:{$ne:""}}).then(m=>{alert("delete success!"),s.findOne("postgraduate-task","task").then(h=>{l.value=h}).catch(h=>{console.log(h)})}).finally(()=>{d.$loading.hide()})}return(n,m)=>(a(),i("div",Me,[Se,e("section",Ce,[Y(j,{message:"finished total task number"},{default:T(()=>[e("p",{class:"profile-info-message",ref_key:"total_task_number",ref:S},"total: "+g(c.length),513)]),_:1}),Y(j,{message:"today finished task number"},{default:T(()=>[e("p",{class:"profile-info-message",ref_key:"today_task_number",ref:p},"today: "+g(ae($)),513)]),_:1})]),e("section",De,[l.value?(a(),i("button",{key:0,class:"profile-task-edit",onClick:u},"Edit")):D("",!0),l.value?(a(),i("button",{key:1,class:"profile-task-delete",onClick:k},"Delete")):D("",!0),l.value?(a(),i("ol",Ye,[(a(!0),i(x,null,I(l.value.task_list,h=>(a(),i("li",{class:"profile-task-item",key:h},[xe,e("span",null,g(h.name),1),Ie,e("span",null,g(h.describe),1)]))),128))])):(a(),i("p",Te,[se("no task to finish, to define your "),e("span",{class:"profile-task-no-add",onClick:_},"tasks")]))]),f.value?(a(),K(we,{key:0,onClose:m[0]||(m[0]=()=>f.value=!1),is_update:r.value},null,8,["is_update"])):D("",!0),e("section",{class:"profile-sticky-container"},[e("button",{class:"profile-sticky-button",onClick:t},"Snuggle"),Fe]),c.length>0?(a(),i("section",Be,[Y(ue,{submission_list:c},null,8,["submission_list"])])):D("",!0)]))}}),Oe=M(Ne,[["__scopeId","data-v-e644a59f"]]);export{Oe as default};
