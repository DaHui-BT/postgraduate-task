import{d as D,g as w,u as v,D as C,r as Y,o as n,c,b as t,F as y,e as p,t as e,f as b,h as f,i as x,w as M,p as $,j as S,_ as T}from"./index-CoWUiQRq.js";import{h as m,P as I}from"./PTButton-BF17qq1j.js";const a=l=>($("data-v-da859e45"),l=l(),S(),l),q={class:"community"},B=a(()=>t("h2",{class:"community"},"Community",-1)),F={class:"community-user-container"},H={class:"community-user-table"},E={class:"community-user-table-info"},L=a(()=>t("td",{class:"community-user-table-title"},"Username",-1)),N=a(()=>t("td",{class:"community-user-table-title"},"Email",-1)),R={class:"community-user-table-date"},V=a(()=>t("td",{class:"community-user-table-title"},"Register Date",-1)),P=a(()=>t("td",{class:"community-user-table-title"},"Lastest Submit Date",-1)),j={class:"community-user-table-status"},O=a(()=>t("td",{class:"community-user-table-title"},"Total Finishing Tasks",-1)),U=a(()=>t("td",{class:"community-user-table-title"},"Today Finishing Tasks",-1)),z={class:"community-user-table-describe"},A=a(()=>t("td",{class:"community-user-table-title"},"Describe",-1)),G={colspan:"3"},J={class:"community-user-table-task"},K=a(()=>t("td",{class:"community-user-table-title"},"Task",-1)),Q={colspan:"3",class:"community-user-table-task-container"},W={class:"community-user-table-task-name"},X=D({__name:"Community",setup(l){var h;const d=(h=w())==null?void 0:h.proxy;if(d==null||d==null)throw Error("Server, please try later");const k=v(),u=new C,r=Y([]);d.$loading.show(),u.findList("postgraduate-task","user").then(async i=>{if(r.splice(0,r.length),i)for(let o of i)await u.count("postgraduate-task","submission",{user_id:{$eq:o._id}}).then(s=>{o.total_finish_task_num=s}),await u.count("postgraduate-task","submission",{date:{$gte:new Date(m().format("YYYY-MM-DD"))},user_id:{$eq:o._id}}).then(s=>{o.today_finish_task_num=s}),await u.findOne("postgraduate-task","task",{user_id:{$eq:o._id}}).then(s=>{s&&(o.task_list=s.task_list)}),r.push(o)}).finally(()=>{d.$loading.hide()});function g(i){k.push({path:"/submission",query:{_id:i}})}return(i,o)=>(n(),c("div",q,[B,t("div",F,[(n(!0),c(y,null,p(r,s=>(n(),c("div",{class:"community-user-item",key:s._id},[t("table",H,[t("tr",E,[L,t("td",null,e(s.username),1),N,t("td",null,e(s.email),1)]),t("tr",R,[V,t("td",null,e(b(m)(s.register_date).format("YY-MM-DD HH:mm:ss")),1),P,t("td",null,e(b(m)(s.update_date).format("YY-MM-DD HH:mm:ss")),1)]),t("tr",j,[O,t("td",null,e(s.total_finish_task_num),1),U,t("td",null,e(s.today_finish_task_num),1)]),t("tr",z,[A,t("td",G,e(s.describe),1)]),t("tr",J,[K,t("td",Q,[(n(!0),c(y,null,p(s.task_list,_=>(n(),c("li",{key:_.name},[t("span",W,e(_.name)+": ",1),f(" "+e(_.describe),1)]))),128))])])]),x(I,{class:"community-user-table-button",width:"100%",onClick:_=>g(s._id)},{default:M(()=>[f("Read More")]),_:2},1032,["onClick"])]))),128))])]))}}),st=T(X,[["__scopeId","data-v-da859e45"]]);export{st as default};
